{"version":3,"file":"index.UQWz7Qyx.js","sources":["../../../src/utils/request.ts","../../../src/pages/Home/data.ts","../../../src/pages/Home/index.tsx","../../../src/service/userService/index.ts","../../../src/assets/xmsImg.svg","../../../src/assets/useer.svg"],"sourcesContent":["import request, { InternalAxiosRequestConfig, AxiosResponse } from 'axios';\nimport { notification } from 'antd';\nimport { getCookie } from './cookies.ts';\ntype ParamValue = string | number | null | undefined | boolean | Date;\ninterface IParamsType {\n  [key: string]: ParamValue | ParamValue[];\n}\n\ninterface ISAxiosResponse {\n  handleRaw?: boolean;\n}\n\ninterface IResponseConfig<T> {\n  url: string;\n  data?: T;\n  params?: ISAxiosResponse;\n}\n\nrequest.interceptors.request.use(\n  (config: InternalAxiosRequestConfig) => {\n    const token = getCookie('token');\n    if (token) {\n      config.headers = config.headers || {};\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    throw new Error(error);\n  },\n);\n\nconst getQueryString = (params: IParamsType): string => {\n  if (!params) return '';\n  const result: string[] = [];\n  Object.keys(params).forEach((key) => {\n    const value = params[key];\n    if (Array.isArray(value)) {\n      result.push(`${key}=${encodeURIComponent(value.join(','))}`);\n    } else {\n      result.push(`${key}=${encodeURIComponent(String(value))}`);\n    }\n  });\n  return result.join('&');\n};\n\nconst parse = (res: AxiosResponse, params: ISAxiosResponse) => {\n  const { status, data } = res;\n  const { handleRaw } = params;\n  switch (status) {\n    case 200:\n      if (handleRaw) {\n        return res.data;\n      }\n      if (data.code === 0) {\n        return res.data.data;\n      } else if (data.code === 401) {\n        notification.open({\n          type: 'warning',\n          message: '提示',\n          description: '登陆超时,请你重新登陆',\n          placement: 'bottomRight',\n          duration: 5000,\n        });\n        window.location.reload();\n        return;\n      } else {\n        notification.open({\n          type: 'error',\n          message: '提示',\n          description: data.message || '系统异常',\n          placement: 'bottomRight',\n          duration: 5000,\n        });\n      }\n      break;\n    case 401:\n      notification.open({\n        type: 'warning',\n        message: '提示',\n        description: '登陆超时,请你重新登陆',\n        placement: 'bottomRight',\n        duration: 5000,\n      });\n      window.location.reload();\n      break;\n    default:\n      notification.open({\n        type: 'error',\n        message: '提示',\n        description: data.message || '系统异常',\n        placement: 'bottomRight',\n        duration: 5000,\n      });\n      return;\n  }\n};\n\nconst get = async <T>(params: IResponseConfig<T>) => {\n  try {\n    const queryValues = getQueryString(params.data || {});\n    const result: AxiosResponse = await request.get(\n      queryValues ? `${params.url}?${queryValues}` : params.url,\n    );\n    return parse(result, params.params || {});\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n};\n\nconst post = async <T>(params: IResponseConfig<T>) => {\n  try {\n    const result: AxiosResponse = await request.post(params.url, params.data);\n    return parse(result, params.params || {});\n  } catch (error) {\n    console.log(error, '请求错误', {});\n    return null;\n  }\n};\n\nconst put = async <T>(params: IResponseConfig<T>) => {\n  try {\n    const result: AxiosResponse = await request.put(params.url, params.data);\n    return parse(result, params.params || {});\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst del = async <T>(params: IResponseConfig<T>) => {\n  try {\n    const result: AxiosResponse = await request.delete(params.url, { data: params.data });\n    return parse(result, params.params || {});\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n};\n\n/**\n * 上传文件\n */\nconst uploadFile = async <T>(params: IResponseConfig<T>) => {\n  try {\n    const formData = new FormData();\n    if (Array.isArray(params.data)) {\n      params.data.forEach((file) => {\n        if (file instanceof Blob || file instanceof File) {\n          formData.append('files', file); // 使用 'files' 作为字段名以支持多个文件\n        }\n      });\n    } else if (params.data instanceof Blob || params.data instanceof File) {\n      formData.append('file', params.data);\n    }\n\n    const result: AxiosResponse = await request.post(params.url, formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n    return parse(result, params.params || {});\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n};\n\nexport { get, post, put, del, uploadFile };\n","import React from 'react';\nimport { IRouterResponse } from '@/service/userService/userServiceType.ts';\nexport interface IMenuItem {\n  id: string;\n  label: string;\n  icon?: React.ReactNode;\n  path?: string;\n  children?: IMenuItem[];\n}\n\nexport const convertToMenuItems = (items: IRouterResponse[]): IMenuItem[] =>\n  items.map((item) => {\n    return {\n      id: item.id,\n      label: item.label,\n      path: item.path,\n      children: item.children ? convertToMenuItems(item.children) : undefined,\n    };\n  });\n","import React, { useEffect, useState } from 'react';\nimport type { MenuProps } from 'antd';\nimport { Input, Layout, Menu } from 'antd';\nimport { Link, Outlet, useLocation } from 'react-router-dom';\nimport { getRouters } from '@/service/userService';\nimport userImg from '@/assets/useer.svg';\nimport xmsImg from '@/assets/xmsImg.svg';\nimport { convertToMenuItems, IMenuItem } from './data.ts';\n\nimport './index.scss';\n\nconst { Header, Content, Sider } = Layout;\n\nconst formatMenuItems = (items: IMenuItem[]): MenuProps['items'] => {\n  if (!items || items.length === 0) return [];\n  return items.map((item) => {\n    return {\n      key: item.id,\n      label: item.path ? <Link to={item.path}>{item.label}</Link> : item.label,\n      icon: item.icon,\n      children: item.children ? formatMenuItems(item.children) : undefined,\n    };\n  });\n};\n\nconst Home: React.FC = () => {\n  const location = useLocation();\n  const [searchText, setSearchText] = useState('');\n  const [menuData, setmenuData] = useState<IMenuItem[]>([]);\n\n  const getMenuData = async () => {\n    const res = await getRouters();\n    setmenuData(convertToMenuItems(res));\n  };\n\n  useEffect(() => {\n    getMenuData();\n  }, []);\n\n  // 根据搜索文本过滤菜单\n  const filterMenu = (items: IMenuItem[]): IMenuItem[] => {\n    if (items.length === 0 || !items) return [];\n    return items.filter((item) => {\n      const match = item.label.toLowerCase().includes(searchText.toLowerCase());\n      if (item.children) {\n        const childMatch = filterMenu(item.children);\n        return childMatch.length > 0 || match;\n      }\n      return match;\n    });\n  };\n\n  const getSelectedKeys = () =>\n    menuData\n      .flatMap(getAllPaths)\n      .filter((p) => p.path === location.pathname)\n      .map((p) => p.id);\n\n  // 递归获取所有路径\n  const getAllPaths = (item: IMenuItem): Array<{ id: string; path: string }> => {\n    if (item.path) return [{ id: item.id, path: item.path }];\n    return item.children?.flatMap(getAllPaths) || [];\n  };\n\n  return (\n    <div className='asp-comprehension-home'>\n      <Layout style={{ height: '100%', width: '100%' }}>\n        <Sider collapsedWidth='0' width={220} theme='light'>\n          <div className='asp-comprehension-home-menu'>\n            <div className='asp-comprehension-home-menu-logo'>\n              <img src={xmsImg} alt='' />\n              <span className='asp-comprehension-home-menu-logo-title'>售后管理系统</span>\n            </div>\n            <div className='asp-comprehension-home-menu-search'>\n              <Input\n                variant='filled'\n                placeholder='搜索'\n                allowClear\n                onChange={(e) => setSearchText(e.target.value)}\n              />\n            </div>\n            <div className='asp-comprehension-home-menu-content'>\n              <Menu\n                theme='light'\n                mode='inline'\n                selectedKeys={getSelectedKeys()}\n                items={formatMenuItems(filterMenu(menuData))}\n                defaultOpenKeys={menuData.map((item) => item.id)}\n              />\n            </div>\n          </div>\n        </Sider>\n\n        <Layout>\n          <Header className='asp-comprehension-home-header'>\n            <div className='asp-comprehension-home-header-content'>\n              <div className='asp-comprehension-home-header-content-user'>\n                <img src={userImg} alt='' />\n                <div>你猜猜我是谁</div>\n              </div>\n            </div>\n          </Header>\n          <Content>\n            <div className='asp-comprehension-home-content'>\n              <Outlet />\n            </div>\n          </Content>\n        </Layout>\n      </Layout>\n    </div>\n  );\n};\n\nexport default Home;\n","import { post, get } from '@/utils/request';\nimport { IRouterResponse, IUserinfoResponse, IUuserParams } from './userServiceType.ts';\n\nexport const login = (data: IUuserParams): Promise<IUserinfoResponse> =>\n  post({ url: '/login', data: data || {} });\n\nexport const getUserInfo = (): Promise<IUserinfoResponse> => get({ url: '/user' });\n\nexport const getRouters = (): Promise<IRouterResponse[]> => post({ url: '/router' });\n","export default \"data:image/svg+xml,%3csvg%20t='1737884521243'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='58228'%20width='200'%20height='200'%3e%3cpath%20d='M512%2028.444444L56.888889%20270.222222v483.555556L512%20995.555556l455.111111-241.777778v-483.555556L512%2028.444444z%20m227.555556%20343.608889v185.457778h-273.066667v-91.022222h182.044444v-91.022222h-273.066666v273.066666H739.555556V739.555556H284.444444V284.444444h455.111112v87.608889z'%20fill='%23ffffff'%20p-id='58229'%3e%3c/path%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20t='1737883886546'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='24110'%20width='200'%20height='200'%3e%3cpath%20d='M512%20512m-512%200a512%20512%200%201%200%201024%200%20512%20512%200%201%200-1024%200Z'%20fill='%23EFEFEF'%20p-id='24111'%3e%3c/path%3e%3cpath%20d='M444.842667%20213.845333l-8.405334%200.384a74.154667%2074.154667%200%200%200-16.512%202.133334c-16.256%204.224-25.514667%2015.104-28.032%2027.818666l-0.682666%205.034667c-0.213333%203.242667%200%206.357333%200.554666%209.386667l0.512%202.090666-2.346666%202.005334c-18.218667%2015.488-35.072%2038.698667-36.522667%2068.352l-1.28%208.405333a304.469333%20304.469333%200%200%200%201.066667%2071.722667l0.682666%204.181333-1.877333%202.218667a40.576%2040.576%200%200%200-8.576%2026.453333c0.938667%2019.029333%207.082667%2042.965333%2022.954667%2065.28l3.498666%204.650667c2.432%203.072%205.248%206.357333%209.557334%2011.093333l3.498666%203.925333c27.008%2029.738667%2037.248%2046.805333%2039.936%2076.501334l0.64%208.618666%200.213334%207.424%200.512-0.298666c-5.461333%203.285333-15.402667%207.125333-30.805334%2011.093333a358.144%20358.144%200%200%201-19.328%204.352l-9.984%201.834667a370.901333%20370.901333%200%200%201-13.866666%202.176c-31.146667%205.248-57.514667%2014.592-78.762667%2027.989333a128.64%20128.64%200%200%200-42.410667%2042.496c-12.629333%2021.162667-16.469333%2041.685333-15.616%2057.642667l-0.042666%2012.757333c0%2016.213333%2013.312%2029.098667%2029.44%2029.098667h538.197333c16.170667%200%2029.44-12.928%2029.44-29.098667V768c1.024-14.848-2.602667-35.2-15.146667-56.192a128.426667%20128.426667%200%200%200-42.325333-42.453333c-21.248-13.44-47.786667-22.997333-79.232-28.629334l-9.728-1.493333-4.266667-0.725333a389.162667%20389.162667%200%200%201-29.098666-6.144l-6.058667-1.621334a111.957333%20111.957333%200%200%201-24.448-9.216v-1.365333c0-3.2%200.256-8.064%200.853333-14.677333%202.474667-27.392%2011.434667-44.074667%2034.005334-69.845334l14.933333-16.768a124.288%20124.288%200%200%200%2030.506667-74.666666c0-6.101333-0.64-10.88-2.133334-15.488l-1.450666-3.84a43.477333%2043.477333%200%200%200-6.485334-10.368l1.28-9.728a258.56%20258.56%200%200%200%201.109334-13.824%20289.28%20289.28%200%200%200-1.109334-52.778667l-1.493333-9.813333a100.992%20100.992%200%200%200-2.901333-13.781334%20113.578667%20113.578667%200%200%200-23.210667-44.928c-22.784-24.789333-73.6-49.152-160.682667-55.637333a310.741333%20310.741333%200%200%200-38.570666-0.170667z'%20fill='%234A4A4A'%20p-id='24112'%3e%3c/path%3e%3c/svg%3e\""],"names":["request","interceptors","use","config","token","getCookie","headers","Authorization","concat","error","Error","post","async","params","res","status","data","handleRaw","code","notification","open","type","message","description","placement","duration","window","location","reload","parse","url","convertToMenuItems","items","map","item","id","label","path","children","Header","Content","Sider","Layout","formatMenuItems","length","key","jsx","Link","to","icon","Home","useLocation","searchText","setSearchText","useState","menuData","setmenuData","getMenuData","useEffect","filterMenu","filter","match","toLowerCase","includes","getAllPaths","_a","flatMap","className","style","height","width","collapsedWidth","theme","jsxs","src","alt","jsxRuntimeExports","Input","variant","placeholder","allowClear","onChange","e","target","value","Menu","mode","selectedKeys","p","pathname","defaultOpenKeys","Outlet"],"mappings":"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"}